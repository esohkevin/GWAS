pcs=read.table("pca.txt", header=T, as.is=T)
par(mfrow=c(1,1))
with(genome, plot(Z0,Z1, xlim = c(0,1), ylim = c(0,1), type = "n", pch=20))
with(subset(genome,RT=="FS"), points(Z0,Z1, col=3))
with(subset(genome,RT=="HS"), points(Z0,Z1, col="darkorange"))
with(subset(genome,RT=="OT"), points(Z0,Z1, col=4))
with(subset(genome,RT=="PO"), points(Z0,Z1, col=2))
with(subset(genome,RT=="UN"), points(Z0,Z1, col=1))
with(subset(genome,RT=="OT"), points(Z0,Z1, col=4))
with(subset(genome,RT=="HS"), points(Z0,Z1, col="darkorange"))
with(pcs, plot(cov1,cov2, xlim = c(0,1), ylim = c(0,1), type = "n", pch=20))
pcs=read.table("pca.txt", header=T, as.is=T)
par(mfrow=c(1,1))
with(pcs, plot(cov1,cov2, xlim = c(-1,0.2), ylim = c(-0.5,0.5), type = "n", pch=20))
with(subset(pcs,ET=="BA"), points(cov1,cov2, col="black"))
with(subset(pcs,ET=="BM"), points(cov1,cov2, col="red"))
with(subset(pcs,ET=="SBM"), points(cov1,cov2, col="yellow"))
with(subset(pcs,ET=="NC"), points(cov1,cov2, col="blue"))
with(subset(pcs,ET=="FM"), points(cov1,cov2, col="orange"))
with(subset(pcs,ET=="FO"), points(cov1,cov2, col="navy"))
with(subset(pcs,ET=="NA"), points(cov1,cov2, col="white"))
camgs=read.table("cam_gwas.sample", header=T, as.is=T)
camtempl=read.table("camgwas_template.sample", header=T, as.is=T)
head(camgs)
head(camtempl)
templfile=data.frame(ID_1=camgs$ID_1, ID_2=camgs$ID_1, camtempl[,3:5])
head(templfile)
write.table(templfile, file="camgwas_template.sample", col.names=T, row.names=F, quote=F)
dir()
=read.table("camgwas_template.sample", header=T, as.is=T)
rawdf=read.table("raw-camgwas.sample", header=T, as.is=T)
head(rawdf)
head(camtempl)
samfile=data.frame(camtempl[,1:2], rawdf[,3:15])
head(samfile)
write.table(samfile, file="raw-camgwas.sample", col.names=T, row.names=F, quote=F)
rawdf=read.table("raw-camgwas.sample", header=T, as.is=T)
temphe=read.table("sample.phe", header=T, as.is=T)
newphe=data.frame(FID=rawdf$ID_1, IID=rawdf$ID_2, rawdf[,4])
write.table(newphe, file="camgwas.phe", col.names=T, row.names=F, quote=F)
write.table(newphe, file="camgwas.sex", col.names=T, row.names=F, quote=F)
covfile=data.frame(FID=rawdf$ID_1, IID=rawdf$ID_2, rawdf[,5])
write.table(covfile, file="camgwas.phe", col.names=T, row.names=F, quote=F)
covfile=data.frame(FID=rawdf$ID_1, IID=rawdf$ID_2, rawdf[,6:15])
write.table(covfile, file="camgwas.cov", col.names=T, row.names=F, quote=F)
q()
newphe=data.frame(FID=rawdf$ID_1, IID=rawdf$ID_2, sex=rawdf[,4])
write.table(newphe, file="camgwas.sex", col.names=T, row.names=F, quote=F)
newphe=data.frame(FID=rawdf$ID_1, IID=rawdf$ID_2, pheno1=rawdf[,5])
write.table(newphe, file="camgwas.phe", col.names=T, row.names=F, quote=F)
q()
